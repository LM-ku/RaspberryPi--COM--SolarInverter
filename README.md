 # RaspberryPi--COM--SolarInverter
  
 Monitoring and control for solar inverter. Python, JS

----------------------------------------------------------------------------------------------------------------------------------------
- <b>HS_MS_MSX_RS232_Protocol_20140822_after_current_upgrade.pdf</b>

 Описание протокола обмена через COM-порт с солнечными гибридными инверторами типа PIP, MPP и другими аналогичными
 
----------------------------------------------------------------------------------------------------------------------------------------
 - <b>SOLAR_inverter_serial_emulator.py</b> 
 
Cкрипт для эмуляции обмена с инвертором. Работает на PC, используется порт СОМ7. Реагирует на запросы : QPIGS, QPIRI, QMOD и QPIWS.
В ответ отправляет данные. Параметры инвертора формируются случайным образом, режимы работы и алармы последовательным перебором.

----------------------------------------------------------------------------------------------------------------------------------------
- <b>test_solar_inverter.py</b>

Тестирование обмена с инвертором через СОМ-порт. Проверяет реакцию инвертора на запросы QID, QPIGS, QPIRI, QMOD и QPIWS.
Вычисляет СRC16 и проверяет корректность полученных данных, определяет количество полученных байт, включая CRC и код конца строки.
Результат обмена отображается на экране и записывается в файл. 
Настройки СОМ-порта и имя файла в теле скрипта.

----------------------------------------------------------------------------------------------------------------------------------------
- <b>solar_mqtt_client.py</b>

Скрипт для обмена с солнечными гибридными инверторами через типа PIP, MPP и другими аналогичными через СОМ-порт и публикации полученных данных на MQTT брокере. Формирует запросы инвертору : QPIGS, QPIRI, QMOD и QPIWS, получает и ответную информацию, осуществляет первичную обработку и некоторые расчеты. Может формировать команды для инвертора POP, PCP, PGR, PBCV, PSDV, PBDV при получении соответствующих запросов через MQTT брокера.   
Требует установки пакетов  <b>paho.mqtt.client</b>  и  <b>serial</b>.
Работает на RaspberryPi под Python 3 (3.5, 3.7 ...)

----------------------------------------------------------------------------------------------------------------------------------------
- <b>energy_statistics.js</b>

Скрипт для учета выработанной и потребленной электроэнергии в среде ioBroker.
По обновлению полученных от инвертора значений солнечной энергии и потребленной электроэнергии формируются запросы в InfluxDB.
Результатом являются полученные данные с начала текущего часа, суток, недели, месяца, года и суммарное значение за все время (в зависимости от настроек хранения данных в InfluxDB)
